'\"!  tbl | mmdoc
'\"macro stdmacro
.if n .pH gen.copyresp @(#)copyresp	40.5 of 7/1/91
.\" Copyright 1991 UNIX System Laboratories, Inc.
.nr X
.if \nX=0 .ds x} copyresp D4DK "STREAMS" "DDI/DKI" "\&"
.if \nX=1 .ds x} copyresp D4DK "STREAMS" "DDI/DKI"
.if \nX=2 .ds x} copyresp D4DK "" "\&"
.if \nX=3 .ds x} copyresp "" "" "\&"
.TH \*(x}
.IX "\f4copyresp\fP(D4DK)"
.SH NAME
\f4copyresp\fP \- STREAMS transparent \f4ioctl\fP copy response structure
.SH SYNOPSIS
\f4#include <sys/stream.h>\f1
.SH DESCRIPTION
The \f4copyresp\fP structure contains information in response to a prior copy request
necessary to continue processing
transparent \f4ioctl\fPs.
\f4M_IOCDATA\fP
messages, generated by the stream head, contain the \f4copyresp\fP structure.
.SH STRUCTURE MEMBERS
.P
.TS
lf4p8 2 lf4p8 2 lf4p8.
int	cp_cmd;	/* ioctl command */
cred_t	*cp_cr;	/* user credentials */
uint_t	cp_id;	/* ioctl ID */
caddr_t	cp_rval;	/* status of request */
mblk_t	*cp_private;	/* module private data */
.TE
.P
The \f4cp_cmd\fP field is the \f4ioctl\fP command, copied from the \f4cq_cmd\fP field
of the \f4copyreq\fP structure.
.P
The \f4cp_cr\fP field contains a pointer to the user credentials.
It is copied from the \f4cq_cr\fP field of the \f4copyreq\fP structure.
.P
The \f4cp_id\fP field is the \f4ioctl\fP ID, copied from the \f4cq_id\fP field
of the \f4copyreq\fP structure.
It is used to uniquely identify the \f4ioctl\fP
request in the stream.
.P
The \f4cq_rval\fP field contains the return value from the last copy request.
If the request succeeded, it is set to 0.
Otherwise, if it is non-zero, the request failed.
On success, the module or driver should continue processing the \f4ioctl\fP.
On failure, the module or driver should abort \f4ioctl\fP processing and free the message.
No \f4M_IOCNAK\fP message need be generated.
.P
The \f4cp_private\fP field is copied from the \f4cq_private\fP field
of the \f4copyreq\fP structure.
It is available so that the module or driver can regain enough state
information to continue processing the \f4ioctl\fP request.
.SH NOTES
If an \f4M_IOCDATA\fP message is reused, any unused fields in the new message should be
cleared.
.P
When the \f4M_IOCDATA\fP message is freed, any message that \f4cp_private\fP
refers to is not freed by the STREAMS subsystem.
It is the responsibility of the module or driver to free it.
.SH SEE ALSO
\f2Programmer's Guide: STREAMS\fP
.P
.na
\f4datab\fP(D4DK),
\f4msgb\fP(D4DK),
\f4copyreq\fP(D4DK),
\f4iocblk\fP(D4DK),
\f4messages\fP(D5DK)
.ad
